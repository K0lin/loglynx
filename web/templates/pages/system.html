{{define "system.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - LogLynx</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/images/favicon.svg">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/static/css/theme.css" rel="stylesheet">
    <link href="/static/css/layout.css" rel="stylesheet">
    <link href="/static/css/charts.css" rel="stylesheet">
    <link href="/static/css/tooltip.css" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        {{template "sidebar" .}}
        <div class="sidebar-overlay"></div>
        <div class="main-content">
            {{template "header" .}}
            <main class="page-content">

<div class="page-header">
    <div class="page-header-top">
        <div>
            <h2 class="page-title">
                <i class="{{.PageIcon}}"></i>
                {{.PageTitle}}
            </h2>
            <p class="page-description">System health, performance metrics, and database statistics</p>
        </div>
        <div class="page-actions">
            <button class="btn btn-outline btn-sm" onclick="location.reload()">
                <i class="fas fa-sync-alt"></i> Refresh
            </button>
        </div>
    </div>
</div>

<!-- Process Information -->
<div class="section-header">
    <h4 data-tooltip-key="processInformation" data-tooltip-title="Process Information"><i class="fas fa-microchip"></i> Process Information</h4>
</div>
<div class="grid grid-cols-4 mb-4">
    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="uptime" data-tooltip-title="Uptime" data-tooltip-position="bottom">Uptime</div>
        <div class="stat-value text-success" id="uptime">-</div>
        <div class="stat-subtitle" id="startTime">Started at: -</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="memoryUsage" data-tooltip-title="Memory Usage" data-tooltip-position="bottom">Memory Usage</div>
        <div class="stat-value text-info" id="memoryAlloc">-</div>
        <div class="stat-subtitle" id="memorySys">System: -</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="goRoutines" data-tooltip-title="Go Routines" data-tooltip-position="bottom">Go Routines</div>
        <div class="stat-value" id="numGoroutines">-</div>
        <div class="stat-subtitle" id="numCPU">CPUs: -</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="runtime" data-tooltip-title="Runtime" data-tooltip-position="bottom">Runtime</div>
        <div class="stat-value text-warning" id="gcPause">-</div>
        <div class="stat-subtitle">Go: <span id="goVersion">-</span></div>
        <div class="stat-subtitle">App: <a id="appVersionLink" href="https://github.com/K0lin/loglynx/tree/v{{.AppVersion}}" target="_blank" rel="noopener"><span id="appVersion">-</span></a></div>
    </div>
</div>

<!-- Database Information -->
<div class="section-header">
    <h4 data-tooltip-key="databaseInformation" data-tooltip-title="Database Information"><i class="fas fa-database"></i> Database Information</h4>
</div>
<div class="grid grid-cols-4 mb-4">
    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="totalRecords" data-tooltip-title="Total Records" data-tooltip-position="bottom">Total Records</div>
        <div class="stat-value text-primary" id="totalRecords">-</div>
        <div class="stat-subtitle">HTTP requests stored</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="databaseSize" data-tooltip-title="Database Size" data-tooltip-position="bottom">Database Size</div>
        <div class="stat-value text-info" id="databaseSize">-</div>
        <div class="stat-subtitle" id="databasePath">-</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="recordsToCleanup" data-tooltip-title="Records to Cleanup" data-tooltip-position="bottom">Records to Cleanup</div>
        <div class="stat-value text-warning" id="recordsToCleanup">-</div>
        <div class="stat-subtitle" id="retentionDays">Retention: -</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="ingestionRate" data-tooltip-title="Ingestion Rate">Ingestion Rate</div>
        <div class="stat-value text-success" id="requestsPerSecond">-</div>
        <div class="stat-subtitle">requests/second</div>
    </div>
</div>

<!-- Records Timeline Chart -->
<div class="section-header">
    <h4 data-tooltip-key="recordsTimeline" data-tooltip-title="Records Timeline"><i class="fas fa-chart-line"></i> Records Timeline</h4>
</div>
<div class="chart-container medium mb-4">
    <div class="chart-header">
        <div>
            <h5 class="chart-title" data-tooltip-key="databaseGrowth" data-tooltip-title="Database Growth Over Time">Database Growth Over Time</h5>
        </div>
        <div class="time-range-selector">
            <button class="time-range-btn" data-days="7">Week</button>
            <button class="time-range-btn active" data-days="30">Month</button>
            <button class="time-range-btn" data-days="all" id="allTimeBtn">All</button>
        </div>
    </div>
    <canvas id="recordsTimelineChart"></canvas>
</div>

<!-- Cleanup Information -->
<div class="section-header">
    <h4 data-tooltip-key="cleanupRetention" data-tooltip-title="Cleanup & Retention"><i class="fas fa-broom"></i> Cleanup & Retention</h4>
</div>
<div class="grid grid-cols-3 mb-4">
    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="nextCleanup" data-tooltip-title="Next Cleanup">Next Cleanup</div>
        <div class="stat-value text-info" id="nextCleanupCountdown">-</div>
        <div class="stat-subtitle" id="nextCleanupTime">Scheduled: -</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="lastCleanup" data-tooltip-title="Last Cleanup">Last Cleanup</div>
        <div class="stat-value" id="lastCleanupTime">-</div>
        <div class="stat-subtitle">Last execution</div>
    </div>

    <div class="stat-card">
        <div class="stat-label" data-tooltip-key="recordAgeRange" data-tooltip-title="Record Age Range">Record Age Range</div>
        <div class="stat-value text-muted" id="oldestRecordAge">-</div>
        <div class="stat-subtitle" id="newestRecordAge">Newest: -</div>
    </div>
</div>

<!-- System Details Table -->
<div class="section-header">
    <h4 data-tooltip-key="systemDetails" data-tooltip-title="Detailed Information"><i class="fas fa-list"></i> Detailed Information</h4>
</div>
<div class="table-container mb-4">
    <table class="table table-striped">
        <tbody id="systemDetailsTable">
            <tr><td colspan="2" class="text-center text-muted">Loading...</td></tr>
        </tbody>
    </table>
</div>

            </main>
            {{template "footer" .}}
        </div>
    </div>

    {{template "scripts-common" .}}
    <!-- Page-specific script -->
     
    <script src="/static/js/pages/system.js"></script>
    <script>
        // Initialize mobile menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            LogLynxUtils.setActiveNavItem('system');
            const menuToggle = document.querySelector('.mobile-menu-toggle');
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.sidebar-overlay');

            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                    overlay.classList.toggle('active');
                });
            }

            if (overlay) {
                overlay.addEventListener('click', function() {
                    sidebar.classList.remove('active');
                    overlay.classList.remove('active');
                });
            }
        });
    </script>
</body>
</html>
{{end}}
